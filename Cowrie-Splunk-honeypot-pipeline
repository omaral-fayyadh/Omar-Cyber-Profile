ğŸ›¡ï¸ Cowrie Honeypot â†’ Splunk SIEM Pipeline
A Real-World Security Telemetry Project

By Omar Alfayyadh | Cybersecurity Engineer | Cloud SIEM | Threat Detection

ğŸ¯ Project Overview

This project demonstrates a complete end-to-end threat-detection pipeline, combining the Cowrie honeypot, Splunk Universal Forwarder, and Splunk Enterprise.
It collects, analyzes, and visualizes live cyberattacks against a simulated SSH/Telnet environment hosted on Azure.

ğŸ§  Objective: Build a hands-on SOC simulation that showcases real-world telemetry engineering, log analysis, and SIEM alerting.

ğŸ§© Architecture
[Attackers / Internet]
        â”‚
        â–¼
Cowrie Honeypot (Docker, TCP/2222â€“2223)
        â”‚
        â–¼
Splunk Universal Forwarder (port 9997)
        â”‚
        â–¼
Splunk Indexer / Search Head
  â””â”€ Dashboards
  â””â”€ Alerts
  â””â”€ Geo Map & Analytics

âš™ï¸ Core Components

Component	Purpose
Cowrie	SSH/Telnet honeypot for capturing brute-force and command-injection attempts
Splunk UF	Forwards Cowrie JSON logs to Splunk indexer
Splunk Enterprise	Hosts dashboards, alerts, and data analytics
GeoIP / iplocation	Resolves attacker IPs to countries
Crontab Health Check	Ensures Splunk forwarder uptime and log ingestion

ğŸ“Š Dashboard Highlights

ğŸ§± KPIs: Total Login Attempts, Unique Attacker IPs, Commands Executed

ğŸ“ˆ Trends: Failed vs Successful Logins over time

ğŸ“Š Top Attackers: Bar chart of highest-volume IPs

ğŸ—ºï¸ Geo Map: Real-time distribution of attacking countries

ğŸ’¬ Command Summary: Common payloads (e.g., wget, curl, chmod +x)


ğŸš¨ Alerts Implemented

Alert	                      Description	                           Severity
Brute-Force Burst	    â‰¥20 failed logins per IP in 5 min	         ğŸ”´ High
Password Spray	            â‰¥10 distinct usernames per IP	         ğŸŸ  Medium
Successful Login	    Any success event	                         ğŸ”´ Critical
Suspicious Commands	    Regex match: wget, curl, base64, nc	         ğŸ”´ High
New Attacker IP	            First-time source detected	                 ğŸŸ¡ Info
UF Health Down	            No forwarder heartbeat in 10 min	         ğŸ”´ High


ğŸ“ Key Findings

Attacks began within minutes of exposure.

3 000 failed logins per day targeting root/admin/pi/ubnt.

Originating countries: RU, DE, IN, US.

Command payloads revealed downloader + privilege escalation patterns.

Peak hours: 00:00â€“08:00 UTC, matching global botnet schedules.

ğŸ§­ Executive Summary

This project represents a fully functional SOC pipeline â€” from attack surface exposure to SIEM visualization and automated alerting.

Key Outcomes

Real-world attacker telemetry captured and correlated in Splunk

Scalable log ingestion via forwarder architecture

Custom dashboards & KPI panels for SOC metrics

Actionable alerts simulating Tier 1â€“2 analyst workflows

Documented configs and automation for reproducibility

Technical Competencies Demonstrated

âœ… Splunk Engineering & Dashboard Studio
âœ… Linux & Docker administration
âœ… Log normalization (props/inputs.conf)
âœ… Regex-based detection logic
âœ… Alerting and health monitoring
âœ… Cloud deployment (Azure)

This project demonstrates the full lifecycle of modern threat detection engineering â€” suitable for portfolio inclusion or technical interviews.

â˜ï¸ Next Steps / Expansion Ideas

Migrate ingestion to Microsoft Sentinel (KQL rules)

Add SOAR automation for Slack/email notifications

Use Suricata / Zeek for network-level enrichment

Integrate Threat Intel feeds for IOC correlation

ğŸ“‚ Included Files

File	                                                        Description
dashboards/cowrie_dashboard.json	                        Splunk dashboard export
configs/inputs.conf             	                        Splunk forwarder input config
configs/props.conf                                      	JSON parsing and sourcetype
configs/outputs.conf	                                        Target indexer
docs/Cowrie_Splunk_Honeypot_Report_Omar_Alfayyadh.pdf	        Full write-up
scripts/splunk_health_check.cron	                        Cron health job
